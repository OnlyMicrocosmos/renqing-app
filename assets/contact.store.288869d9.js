import{d as n,g as i,s,a as c}from"./index.45b4ffe3.js";const h=n("contact",{state:()=>({contacts:[],selectedContact:null,filters:{group:"all",searchQuery:"",balanceType:"all"},loading:!1,error:null}),actions:{async loadContacts(){this.loading=!0,this.error=null;try{return this.contacts=await i(),this.contacts}catch(e){throw this.error="\u52A0\u8F7D\u8054\u7CFB\u4EBA\u5931\u8D25: "+e.message,e}finally{this.loading=!1}},async createContact(e){this.loading=!0;try{const r=await s({...e,id:Date.now().toString(),createdAt:new Date().toISOString()});return this.contacts.unshift(r),r}catch(r){throw this.error="\u521B\u5EFA\u8054\u7CFB\u4EBA\u5931\u8D25: "+r.message,r}finally{this.loading=!1}},async updateContact(e,r){this.loading=!0;try{const t=this.contacts.findIndex(o=>o.id===e);if(t===-1)throw new Error("\u8054\u7CFB\u4EBA\u672A\u627E\u5230");const a={...this.contacts[t],...r,updatedAt:new Date().toISOString()};return await s(a),this.contacts.splice(t,1,a),a}catch(t){throw this.error="\u66F4\u65B0\u8054\u7CFB\u4EBA\u5931\u8D25: "+t.message,t}finally{this.loading=!1}},async deleteContact(e){var r;this.loading=!0;try{await c(e),this.contacts=this.contacts.filter(t=>t.id!==e),((r=this.selectedContact)==null?void 0:r.id)===e&&(this.selectedContact=null)}catch(t){throw this.error="\u5220\u9664\u8054\u7CFB\u4EBA\u5931\u8D25: "+t.message,t}finally{this.loading=!1}},selectContact(e){this.selectedContact=e},setFilters(e){this.filters={...this.filters,...e}}},getters:{filteredContacts:e=>{let r=[...e.contacts];if(e.filters.group!=="all"&&(r=r.filter(t=>t.group===e.filters.group)),e.filters.searchQuery){const t=e.filters.searchQuery.trim().toLowerCase();r=r.filter(a=>a.name.toLowerCase().includes(t)||a.phone&&a.phone.toLowerCase().includes(t)||a.email&&a.email.toLowerCase().includes(t)||a.notes&&a.notes.toLowerCase().includes(t))}return r.sort((t,a)=>t.name.localeCompare(a.name))},contactGroups:e=>{const r=new Set;return e.contacts.forEach(t=>{t.group&&r.add(t.group)}),["\u6240\u6709\u5206\u7EC4",...Array.from(r)]}}});export{h as useContactStore};
