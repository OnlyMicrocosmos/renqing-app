import{_ as I,m as U,u as F,r as c,w as V,c as k,e as u,f as i,h as l,j as a,I as _,v as w,F as h,E as j,y as d,t as f}from"./index.dca31d16.js";import{useContactStore as B}from"./contact.store.3ccc7ae8.js";const D={class:"event-form"},M={class:"form-group"},T={class:"radio-group"},O={class:"radio-item"},R=["disabled"],L={class:"radio-item"},N=["disabled"],q={class:"form-group"},z=["disabled"],A=["value"],G={class:"form-group"},H=["disabled"],J={class:"form-group"},K=["disabled"],P={class:"form-group"},Q=["disabled"],W={class:"form-group"},X=["disabled"],Y={class:"form-actions"},Z=["disabled"],$=["disabled"],ee={__name:"EventForm",props:{event:{type:Object,default:()=>({id:null,type:"given",contactId:"",description:"",amount:0,date:new Date().toISOString().split("T")[0],notes:""})}},emits:["submit","cancel"],setup(y,{emit:g}){const r=y,v=g,p=U(),m=F(),e=c({...r.event}),n=c(!1);V(()=>r.event,o=>{o&&typeof o=="object"&&(e.value={...o})},{immediate:!0});const S=B(),E=k(()=>S.contacts),x=async()=>{if(!e.value||!e.value.type||!e.value.contactId||!e.value.description||!e.value.amount||!e.value.date){alert("\u8BF7\u586B\u5199\u6240\u6709\u5FC5\u586B\u5B57\u6BB5");return}n.value=!0;try{e.value.id?await m.updateEvent(e.value):await m.createEvent(e.value),v("submit",{...e.value}),p.push("/events")}catch(o){console.error("\u4FDD\u5B58\u4E8B\u4EF6\u5931\u8D25:",o),alert("\u4FDD\u5B58\u4E8B\u4EF6\u5931\u8D25: "+(o.message||"\u672A\u77E5\u9519\u8BEF"))}finally{n.value=!1}},C=()=>{v("cancel"),p.push("/events")},b=()=>{};return(o,t)=>(u(),i("div",D,[l("div",M,[t[9]||(t[9]=l("label",null,"\u4E8B\u4EF6\u7C7B\u578B",-1)),l("div",T,[l("label",O,[a(l("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=s=>e.value.type=s),value:"given",onChange:b,disabled:!e.value},null,40,R),[[_,e.value.type]]),t[7]||(t[7]=l("span",null,"\u9001\u793C",-1))]),l("label",L,[a(l("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=s=>e.value.type=s),value:"received",onChange:b,disabled:!e.value},null,40,N),[[_,e.value.type]]),t[8]||(t[8]=l("span",null,"\u6536\u793C",-1))])])]),l("div",q,[t[11]||(t[11]=l("label",null,"\u8054\u7CFB\u4EBA",-1)),a(l("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.value.contactId=s),disabled:!e.value},[t[10]||(t[10]=l("option",{value:""},"\u8BF7\u9009\u62E9\u8054\u7CFB\u4EBA",-1)),(u(!0),i(h,null,j(E.value,s=>(u(),i("option",{key:s.id,value:s.id},f(s.name),9,A))),128))],8,z),[[w,e.value.contactId]])]),l("div",G,[t[12]||(t[12]=l("label",null,"\u4E8B\u4EF6\u63CF\u8FF0",-1)),a(l("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>e.value.description=s),type:"text",placeholder:"\u8BF7\u8F93\u5165\u4E8B\u4EF6\u63CF\u8FF0",disabled:!e.value},null,8,H),[[d,e.value.description]])]),l("div",J,[t[13]||(t[13]=l("label",null,"\u91D1\u989D/\u4EF7\u503C",-1)),a(l("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.value.amount=s),type:"number",placeholder:"\u8BF7\u8F93\u5165\u91D1\u989D",disabled:!e.value},null,8,K),[[d,e.value.amount,void 0,{number:!0}]])]),l("div",P,[t[14]||(t[14]=l("label",null,"\u65E5\u671F",-1)),a(l("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>e.value.date=s),type:"date",disabled:!e.value},null,8,Q),[[d,e.value.date]])]),l("div",W,[t[15]||(t[15]=l("label",null,"\u5907\u6CE8",-1)),a(l("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>e.value.notes=s),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",rows:"4",disabled:!e.value},null,8,X),[[d,e.value.notes]])]),l("div",Y,[l("button",{class:"btn btn-primary",disabled:n.value||!e.value,onClick:x},f(n.value?"\u63D0\u4EA4\u4E2D...":"\u6DFB\u52A0\u4E8B\u4EF6"),9,Z),l("button",{class:"btn btn-secondary",onClick:C,disabled:!e.value}," \u53D6\u6D88 ",8,$)])]))}};var se=I(ee,[["__scopeId","data-v-7031e619"],["__file","EventForm.vue"]]);export{se as default};
