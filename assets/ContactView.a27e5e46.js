import{_ as b,e as i,f as r,J as k,B as $,h as t,G as g,A as C,t as c,K as Q,u as B,q,i as p,C as w,r as m,o as V,c as R,j as z,y as A,F as M,E as j,x as L,H as N}from"./index.dca31d16.js";import{useContactStore as D}from"./contact.store.3ccc7ae8.js";import T from"./ContactForm.2e283711.js";const G={name:"RQCard",props:{header:{type:String,default:""},shadow:{type:String,default:"always",validator:function(a){return["always","hover","never"].includes(a)}},alwaysShadow:{type:Boolean,default:!1}}},H={key:0,class:"rq-card__header"},J={class:"rq-card__body"};function K(a,e,l,u,f,o){return i(),r("div",{class:g(["rq-card",[l.shadow?`rq-card--shadow-${l.shadow}`:"",{"is-always-shadow":l.alwaysShadow}]])},[a.$slots.header||l.header?(i(),r("div",H,[k(a.$slots,"header",{},()=>[C(c(l.header),1)],!0)])):$("",!0),t("div",J,[k(a.$slots,"default",{},void 0,!0)])],2)}var O=b(G,[["render",K],["__scopeId","data-v-c70bff34"],["__file","RQCard.vue"]]);const P={name:"RQButton",props:{type:{type:String,default:"default",validator:function(a){return["default","primary","success","warning","danger"].includes(a)}},size:{type:String,default:"default",validator:function(a){return["default","small","large"].includes(a)}},plain:{type:Boolean,default:!1},round:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["click"],methods:{handleClick(a){this.disabled||this.$emit("click",a)}}},U=["disabled"];function W(a,e,l,u,f,o){return i(),r("button",{class:g(["rq-button",[l.type?`rq-button--${l.type}`:"",l.size?`rq-button--${l.size}`:"",{"is-plain":l.plain,"is-round":l.round,"is-disabled":l.disabled}]]),disabled:l.disabled,onClick:e[0]||(e[0]=(..._)=>o.handleClick&&o.handleClick(..._))},[k(a.$slots,"default",{},void 0,!0)],10,U)}var X=b(P,[["render",W],["__scopeId","data-v-424638a7"],["__file","RQButton.vue"]]);const Y={name:"ContactCard",components:{RQCard:O,RQButton:X},props:{contact:{type:Object,required:!0,default:()=>({id:null,name:"",relation:"",phone:"",email:"",address:"",note:"",events:[]})}},computed:{...Q(B,["events"]),contactInitial(){return this.contact.name?this.contact.name.charAt(0):"?"},contactEvents(){return this.events.filter(a=>a.contactId===this.contact.id)},totalExpense(){return this.contactEvents.filter(a=>a.type==="given").reduce((a,e)=>a+(e.amount||0),0).toFixed(2)},totalIncome(){return this.contactEvents.filter(a=>a.type==="received").reduce((a,e)=>a+(e.amount||0),0).toFixed(2)},netAmount(){return(parseFloat(this.totalIncome)-parseFloat(this.totalExpense)).toFixed(2)}},methods:{editContact(){this.$emit("edit",this.contact)},deleteContact(){this.$emit("delete",this.contact.id)}}},Z={class:"contact-card"},tt={class:"contact-card__header"},et={class:"contact-card__avatar"},at={class:"contact-card__info"},st={class:"contact-card__name"},nt={class:"contact-card__relation"},lt={class:"contact-card__actions"},ot={class:"contact-card__body"},dt={class:"contact-card__detail"},ct={class:"contact-card__detail-item"},it={class:"contact-card__detail-value"},rt={class:"contact-card__detail-item"},_t={class:"contact-card__detail-value"},ut={class:"contact-card__detail-item"},vt={class:"contact-card__detail-value"},mt={class:"contact-card__detail-item"},ft={class:"contact-card__detail-value"},yt={class:"contact-card__summary"},ht={class:"contact-card__summary-item"},pt={class:"contact-card__summary-value expense"},Ct={class:"contact-card__summary-item"},bt={class:"contact-card__summary-value income"},wt={class:"contact-card__summary-item"};function kt(a,e,l,u,f,o){const _=q("rq-button"),v=q("rq-card");return i(),r("div",Z,[p(v,null,{default:w(()=>[t("div",tt,[t("div",et,c(o.contactInitial),1),t("div",at,[t("h3",st,c(l.contact.name),1),t("p",nt,c(l.contact.relation),1)]),t("div",lt,[p(_,{type:"primary",size:"small",onClick:o.editContact},{default:w(()=>e[0]||(e[0]=[C(" \u7F16\u8F91 ",-1)])),_:1,__:[0]},8,["onClick"]),p(_,{type:"danger",size:"small",onClick:o.deleteContact},{default:w(()=>e[1]||(e[1]=[C(" \u5220\u9664 ",-1)])),_:1,__:[1]},8,["onClick"])])]),t("div",ot,[t("div",dt,[t("div",ct,[e[2]||(e[2]=t("span",{class:"contact-card__detail-label"},"\u7535\u8BDD:",-1)),t("span",it,c(l.contact.phone||"\u672A\u586B\u5199"),1)]),t("div",rt,[e[3]||(e[3]=t("span",{class:"contact-card__detail-label"},"\u90AE\u7BB1:",-1)),t("span",_t,c(l.contact.email||"\u672A\u586B\u5199"),1)]),t("div",ut,[e[4]||(e[4]=t("span",{class:"contact-card__detail-label"},"\u5730\u5740:",-1)),t("span",vt,c(l.contact.address||"\u672A\u586B\u5199"),1)]),t("div",mt,[e[5]||(e[5]=t("span",{class:"contact-card__detail-label"},"\u5907\u6CE8:",-1)),t("span",ft,c(l.contact.note||"\u65E0"),1)])]),t("div",yt,[t("div",ht,[e[6]||(e[6]=t("span",{class:"contact-card__summary-label"},"\u603B\u652F\u51FA:",-1)),t("span",pt,"\xA5"+c(o.totalExpense),1)]),t("div",Ct,[e[7]||(e[7]=t("span",{class:"contact-card__summary-label"},"\u603B\u6536\u5165:",-1)),t("span",bt,"\xA5"+c(o.totalIncome),1)]),t("div",wt,[e[8]||(e[8]=t("span",{class:"contact-card__summary-label"},"\u51C0\u6536\u652F:",-1)),t("span",{class:g(["contact-card__summary-value",o.netAmount>=0?"income":"expense"])}," \xA5"+c(o.netAmount),3)])])])]),_:1})])}var gt=b(Y,[["render",kt],["__scopeId","data-v-9576d888"],["__file","ContactCard.vue"]]);const xt={class:"contact-view"},St={class:"page-header flex-between"},qt={class:"search-box card mb-3"},$t={class:"search-input"},Bt={key:0,class:"loading"},Et={key:1,class:"error"},Ft={key:2},It={key:0,class:"empty-state card"},Qt={key:1,class:"contacts-grid"},Vt={class:"modal-header"},Rt={__name:"ContactView",setup(a){const e=D(),l=B(),u=m(""),f=m(!0),o=m(null),_=m(!1),v=m(!1),y=m(null);V(async()=>{try{await Promise.all([e.loadContacts(),l.loadEvents()])}catch(d){o.value=d.message||"\u52A0\u8F7D\u6570\u636E\u5931\u8D25"}finally{f.value=!1}});const x=R(()=>{var s;if(!u.value)return((s=e.contacts)==null?void 0:s.filter(n=>n&&typeof n=="object"&&n.id!==void 0))||[];const d=u.value.toLowerCase();return(e.contacts||[]).filter(n=>{var S;return n&&typeof n=="object"&&n.id!==void 0&&((S=n.name)==null?void 0:S.toLowerCase().includes(d))||n.phone&&n.phone.includes(d)||n.relation&&n.relation.toLowerCase().includes(d)})}),E=d=>{y.value={...d},v.value=!0},F=async d=>{if(confirm("\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u8054\u7CFB\u4EBA\u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002"))try{await e.deleteContact(d)}catch(s){alert("\u5220\u9664\u8054\u7CFB\u4EBA\u5931\u8D25: "+s.message)}},I=async d=>{try{v.value?await e.updateContact(y.value.id,d):await e.createContact(d),h(),alert("\u8054\u7CFB\u4EBA\u4FDD\u5B58\u6210\u529F")}catch(s){alert("\u4FDD\u5B58\u8054\u7CFB\u4EBA\u5931\u8D25: "+s.message)}},h=()=>{_.value=!1,v.value=!1,y.value=null};return(d,s)=>(i(),r("div",xt,[t("div",St,[s[5]||(s[5]=t("div",null,[t("h1",null,"\u8054\u7CFB\u4EBA\u7BA1\u7406"),t("p",null,"\u7BA1\u7406\u60A8\u7684\u4EBA\u60C5\u5F80\u6765\u8054\u7CFB\u4EBA")],-1)),t("button",{class:"btn",onClick:s[0]||(s[0]=n=>_.value=!0)},s[4]||(s[4]=[t("i",{class:"icon-plus"},null,-1),C(" \u6DFB\u52A0\u8054\u7CFB\u4EBA ",-1)]))]),t("div",qt,[t("div",$t,[s[6]||(s[6]=t("i",{class:"icon-search"},null,-1)),z(t("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>u.value=n),type:"text",placeholder:"\u641C\u7D22\u8054\u7CFB\u4EBA...",class:"search-field"},null,512),[[A,u.value]])])]),f.value?(i(),r("div",Bt,"\u52A0\u8F7D\u4E2D...")):o.value?(i(),r("div",Et,c(o.value),1)):(i(),r("div",Ft,[x.value.length===0?(i(),r("div",It,[s[7]||(s[7]=t("i",{class:"icon-user"},null,-1)),s[8]||(s[8]=t("p",null,"\u6682\u65E0\u8054\u7CFB\u4EBA",-1)),t("button",{class:"btn",onClick:s[2]||(s[2]=n=>_.value=!0)},"\u6DFB\u52A0\u7B2C\u4E00\u4E2A\u8054\u7CFB\u4EBA")])):(i(),r("div",Qt,[(i(!0),r(M,null,j(x.value,n=>(i(),N(gt,{key:(n==null?void 0:n.id)||(n==null?void 0:n.name)||Math.random(),contact:n,onEdit:E,onDelete:F},null,8,["contact"]))),128))]))])),_.value||v.value?(i(),r("div",{key:3,class:"modal-overlay",onClick:h},[t("div",{class:"modal-content",onClick:s[3]||(s[3]=L(()=>{},["stop"]))},[t("div",Vt,[t("h3",null,c(v.value?"\u7F16\u8F91\u8054\u7CFB\u4EBA":"\u6DFB\u52A0\u8054\u7CFB\u4EBA"),1),t("button",{class:"modal-close",onClick:h},"\xD7")]),p(T,{contact:y.value,onSubmit:I,onCancel:h},null,8,["contact"])])])):$("",!0)]))}};var jt=b(Rt,[["__scopeId","data-v-90cbd01e"],["__file","ContactView.vue"]]);export{jt as default};
