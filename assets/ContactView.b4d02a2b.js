import{_ as b,e as d,f as i,J as k,B as q,h as t,G as g,A as C,t as c,K as I,u as $,q as S,i as p,C as w,r as m,o as Q,c as V,j as R,y as z,F as A,E as L,x as M,H as N}from"./index.45b4ffe3.js";import{useContactStore as D}from"./contact.store.288869d9.js";import j from"./ContactForm.f3ed0a03.js";const T={name:"RQCard",props:{header:{type:String,default:""},shadow:{type:String,default:"always",validator:function(s){return["always","hover","never"].includes(s)}},alwaysShadow:{type:Boolean,default:!1}}},G={key:0,class:"rq-card__header"},H={class:"rq-card__body"};function J(s,e,n,_,f,o){return d(),i("div",{class:g(["rq-card",[n.shadow?`rq-card--shadow-${n.shadow}`:"",{"is-always-shadow":n.alwaysShadow}]])},[s.$slots.header||n.header?(d(),i("div",G,[k(s.$slots,"header",{},()=>[C(c(n.header),1)],!0)])):q("",!0),t("div",H,[k(s.$slots,"default",{},void 0,!0)])],2)}var K=b(T,[["render",J],["__scopeId","data-v-c70bff34"],["__file","RQCard.vue"]]);const O={name:"RQButton",props:{type:{type:String,default:"default",validator:function(s){return["default","primary","success","warning","danger"].includes(s)}},size:{type:String,default:"default",validator:function(s){return["default","small","large"].includes(s)}},plain:{type:Boolean,default:!1},round:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["click"],methods:{handleClick(s){this.disabled||this.$emit("click",s)}}},P=["disabled"];function U(s,e,n,_,f,o){return d(),i("button",{class:g(["rq-button",[n.type?`rq-button--${n.type}`:"",n.size?`rq-button--${n.size}`:"",{"is-plain":n.plain,"is-round":n.round,"is-disabled":n.disabled}]]),disabled:n.disabled,onClick:e[0]||(e[0]=(...r)=>o.handleClick&&o.handleClick(...r))},[k(s.$slots,"default",{},void 0,!0)],10,P)}var W=b(O,[["render",U],["__scopeId","data-v-424638a7"],["__file","RQButton.vue"]]);const X={name:"ContactCard",components:{RQCard:K,RQButton:W},props:{contact:{type:Object,required:!0,default:()=>({id:null,name:"",relation:"",phone:"",email:"",address:"",note:"",events:[]})}},computed:{...I($,["events"]),contactInitial(){return this.contact.name?this.contact.name.charAt(0):"?"},contactEvents(){return this.events.filter(s=>s.contactId===this.contact.id)},totalExpense(){return this.contactEvents.filter(s=>s.type==="given").reduce((s,e)=>s+(e.amount||0),0).toFixed(2)},totalIncome(){return this.contactEvents.filter(s=>s.type==="received").reduce((s,e)=>s+(e.amount||0),0).toFixed(2)},netAmount(){return(parseFloat(this.totalIncome)-parseFloat(this.totalExpense)).toFixed(2)}},methods:{editContact(){this.$emit("edit",this.contact)},deleteContact(){this.$emit("delete",this.contact.id)}}},Y={class:"contact-card"},Z={class:"contact-card__header"},tt={class:"contact-card__avatar"},et={class:"contact-card__info"},at={class:"contact-card__name"},st={class:"contact-card__relation"},nt={class:"contact-card__actions"},ot={class:"contact-card__body"},lt={class:"contact-card__detail"},ct={class:"contact-card__detail-item"},dt={class:"contact-card__detail-value"},it={class:"contact-card__detail-item"},rt={class:"contact-card__detail-value"},_t={class:"contact-card__detail-item"},ut={class:"contact-card__detail-value"},vt={class:"contact-card__detail-item"},mt={class:"contact-card__detail-value"},ft={class:"contact-card__summary"},ht={class:"contact-card__summary-item"},yt={class:"contact-card__summary-value expense"},pt={class:"contact-card__summary-item"},Ct={class:"contact-card__summary-value income"},bt={class:"contact-card__summary-item"};function wt(s,e,n,_,f,o){const r=S("rq-button"),u=S("rq-card");return d(),i("div",Y,[p(u,null,{default:w(()=>[t("div",Z,[t("div",tt,c(o.contactInitial),1),t("div",et,[t("h3",at,c(n.contact.name),1),t("p",st,c(n.contact.relation),1)]),t("div",nt,[p(r,{type:"primary",size:"small",onClick:o.editContact},{default:w(()=>e[0]||(e[0]=[C(" \u7F16\u8F91 ",-1)])),_:1,__:[0]},8,["onClick"]),p(r,{type:"danger",size:"small",onClick:o.deleteContact},{default:w(()=>e[1]||(e[1]=[C(" \u5220\u9664 ",-1)])),_:1,__:[1]},8,["onClick"])])]),t("div",ot,[t("div",lt,[t("div",ct,[e[2]||(e[2]=t("span",{class:"contact-card__detail-label"},"\u7535\u8BDD:",-1)),t("span",dt,c(n.contact.phone||"\u672A\u586B\u5199"),1)]),t("div",it,[e[3]||(e[3]=t("span",{class:"contact-card__detail-label"},"\u90AE\u7BB1:",-1)),t("span",rt,c(n.contact.email||"\u672A\u586B\u5199"),1)]),t("div",_t,[e[4]||(e[4]=t("span",{class:"contact-card__detail-label"},"\u5730\u5740:",-1)),t("span",ut,c(n.contact.address||"\u672A\u586B\u5199"),1)]),t("div",vt,[e[5]||(e[5]=t("span",{class:"contact-card__detail-label"},"\u5907\u6CE8:",-1)),t("span",mt,c(n.contact.note||"\u65E0"),1)])]),t("div",ft,[t("div",ht,[e[6]||(e[6]=t("span",{class:"contact-card__summary-label"},"\u603B\u652F\u51FA:",-1)),t("span",yt,"\xA5"+c(o.totalExpense),1)]),t("div",pt,[e[7]||(e[7]=t("span",{class:"contact-card__summary-label"},"\u603B\u6536\u5165:",-1)),t("span",Ct,"\xA5"+c(o.totalIncome),1)]),t("div",bt,[e[8]||(e[8]=t("span",{class:"contact-card__summary-label"},"\u51C0\u6536\u652F:",-1)),t("span",{class:g(["contact-card__summary-value",o.netAmount>=0?"income":"expense"])}," \xA5"+c(o.netAmount),3)])])])]),_:1})])}var kt=b(X,[["render",wt],["__scopeId","data-v-9576d888"],["__file","ContactCard.vue"]]);const gt={class:"contact-view"},xt={class:"page-header flex-between"},St={class:"search-box card mb-3"},qt={class:"search-input"},$t={key:0,class:"loading"},Bt={key:1,class:"error"},Et={key:2},Ft={key:0,class:"empty-state card"},It={key:1,class:"contacts-grid"},Qt={class:"modal-header"},Vt={__name:"ContactView",setup(s){const e=D(),n=$(),_=m(""),f=m(!0),o=m(null),r=m(!1),u=m(!1),h=m(null);Q(async()=>{try{await Promise.all([e.loadContacts(),n.loadEvents()])}catch(l){o.value=l.message||"\u52A0\u8F7D\u6570\u636E\u5931\u8D25"}finally{f.value=!1}});const x=V(()=>{if(!_.value)return e.contacts||[];const l=_.value.toLowerCase();return(e.contacts||[]).filter(a=>a.name.toLowerCase().includes(l)||a.phone&&a.phone.includes(l)||a.relation&&a.relation.toLowerCase().includes(l))}),B=l=>{h.value={...l},u.value=!0},E=async l=>{if(confirm("\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u8054\u7CFB\u4EBA\u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002"))try{await e.deleteContact(l)}catch(a){alert("\u5220\u9664\u8054\u7CFB\u4EBA\u5931\u8D25: "+a.message)}},F=async l=>{try{u.value?await e.updateContact(h.value.id,l):await e.createContact(l),y(),alert("\u8054\u7CFB\u4EBA\u4FDD\u5B58\u6210\u529F")}catch(a){alert("\u4FDD\u5B58\u8054\u7CFB\u4EBA\u5931\u8D25: "+a.message)}},y=()=>{r.value=!1,u.value=!1,h.value=null};return(l,a)=>(d(),i("div",gt,[t("div",xt,[a[5]||(a[5]=t("div",null,[t("h1",null,"\u8054\u7CFB\u4EBA\u7BA1\u7406"),t("p",null,"\u7BA1\u7406\u60A8\u7684\u4EBA\u60C5\u5F80\u6765\u8054\u7CFB\u4EBA")],-1)),t("button",{class:"btn",onClick:a[0]||(a[0]=v=>r.value=!0)},a[4]||(a[4]=[t("i",{class:"icon-plus"},null,-1),C(" \u6DFB\u52A0\u8054\u7CFB\u4EBA ",-1)]))]),t("div",St,[t("div",qt,[a[6]||(a[6]=t("i",{class:"icon-search"},null,-1)),R(t("input",{"onUpdate:modelValue":a[1]||(a[1]=v=>_.value=v),type:"text",placeholder:"\u641C\u7D22\u8054\u7CFB\u4EBA...",class:"search-field"},null,512),[[z,_.value]])])]),f.value?(d(),i("div",$t,"\u52A0\u8F7D\u4E2D...")):o.value?(d(),i("div",Bt,c(o.value),1)):(d(),i("div",Et,[x.value.length===0?(d(),i("div",Ft,[a[7]||(a[7]=t("i",{class:"icon-user"},null,-1)),a[8]||(a[8]=t("p",null,"\u6682\u65E0\u8054\u7CFB\u4EBA",-1)),t("button",{class:"btn",onClick:a[2]||(a[2]=v=>r.value=!0)},"\u6DFB\u52A0\u7B2C\u4E00\u4E2A\u8054\u7CFB\u4EBA")])):(d(),i("div",It,[(d(!0),i(A,null,L(x.value,v=>(d(),N(kt,{key:v.id,contact:v,onEdit:B,onDelete:E},null,8,["contact"]))),128))]))])),r.value||u.value?(d(),i("div",{key:3,class:"modal-overlay",onClick:y},[t("div",{class:"modal-content",onClick:a[3]||(a[3]=M(()=>{},["stop"]))},[t("div",Qt,[t("h3",null,c(u.value?"\u7F16\u8F91\u8054\u7CFB\u4EBA":"\u6DFB\u52A0\u8054\u7CFB\u4EBA"),1),t("button",{class:"modal-close",onClick:y},"\xD7")]),p(j,{contact:h.value,onSubmit:F,onCancel:y},null,8,["contact"])])])):q("",!0)]))}};var Lt=b(Vt,[["__scopeId","data-v-06c53251"],["__file","ContactView.vue"]]);export{Lt as default};
